{{define "content"}}
<div class="space-y-6">
    <!-- Header -->
    <div class="sm:flex sm:items-center sm:justify-between">
        <div>
            <nav class="flex" aria-label="Breadcrumb">
                <ol class="flex items-center space-x-2">
                    <li><a href="{{$.BasePath}}/sessions" class="text-gray-400 hover:text-gray-200">Sessions</a></li>
                    <li><span class="text-gray-500">/</span></li>
                    <li class="text-gray-100 font-medium">{{.Data.Session.Session.UserID}}</li>
                </ol>
            </nav>
            <h1 class="mt-2 text-2xl font-semibold text-gray-100">{{.Data.Session.Session.UserID}}</h1>
            <p class="mt-1 text-sm text-gray-400">Tenant: {{.Data.Session.Session.TenantID}}</p>
        </div>
        <div class="mt-4 sm:mt-0 flex space-x-3">
            <a href="{{$.BasePath}}/messages/session/{{.Data.Session.Session.ID}}" class="inline-flex items-center rounded-md bg-gray-700 px-3 py-2 text-sm font-medium text-gray-200 shadow-sm ring-1 ring-inset ring-gray-600 hover:bg-gray-600">
                <svg class="w-4 h-4 mr-2 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"></path>
                </svg>
                View Full Conversation
            </a>
            <a href="{{$.BasePath}}/chat/session/{{.Data.Session.Session.ID}}" class="inline-flex items-center rounded-md bg-cyan-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-cyan-500">
                <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"></path>
                </svg>
                Continue Chat
            </a>
        </div>
    </div>

    <!-- Quick Stats Bar -->
    <div class="grid grid-cols-2 gap-4 sm:grid-cols-4">
        <div class="bg-gray-800 rounded-lg shadow-lg shadow-gray-900/50 border border-gray-700 px-4 py-5 sm:p-6">
            <div class="flex items-center">
                <div class="flex-shrink-0 bg-cyan-500/20 rounded-md p-3">
                    <svg class="h-6 w-6 text-cyan-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"></path>
                    </svg>
                </div>
                <div class="ml-4">
                    <p class="text-sm font-medium text-gray-400">Messages</p>
                    <p class="text-2xl font-semibold text-gray-100">{{.Data.Session.MessageCount}}</p>
                </div>
            </div>
        </div>
        <div class="bg-gray-800 rounded-lg shadow-lg shadow-gray-900/50 border border-gray-700 px-4 py-5 sm:p-6">
            <div class="flex items-center">
                <div class="flex-shrink-0 bg-green-500/20 rounded-md p-3">
                    <svg class="h-6 w-6 text-green-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                    </svg>
                </div>
                <div class="ml-4">
                    <p class="text-sm font-medium text-gray-400">Runs</p>
                    <p class="text-2xl font-semibold text-gray-100">{{.Data.Session.RunCount}}</p>
                </div>
            </div>
        </div>
        <div class="bg-gray-800 rounded-lg shadow-lg shadow-gray-900/50 border border-gray-700 px-4 py-5 sm:p-6">
            <div class="flex items-center">
                <div class="flex-shrink-0 bg-purple-500/20 rounded-md p-3">
                    <svg class="h-6 w-6 text-purple-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"></path>
                    </svg>
                </div>
                <div class="ml-4">
                    <p class="text-sm font-medium text-gray-400">Total Tokens</p>
                    <p class="text-2xl font-semibold text-gray-100">{{formatTokens .Data.Session.TokenUsage.TotalTokens}}</p>
                </div>
            </div>
        </div>
        <div class="bg-gray-800 rounded-lg shadow-lg shadow-gray-900/50 border border-gray-700 px-4 py-5 sm:p-6">
            <div class="flex items-center">
                <div class="flex-shrink-0 bg-yellow-500/20 rounded-md p-3">
                    <svg class="h-6 w-6 text-yellow-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 7v10c0 2.21 3.582 4 8 4s8-1.79 8-4V7M4 7c0 2.21 3.582 4 8 4s8-1.79 8-4M4 7c0-2.21 3.582-4 8-4s8 1.79 8 4"></path>
                    </svg>
                </div>
                <div class="ml-4">
                    <p class="text-sm font-medium text-gray-400">Compactions</p>
                    <p class="text-2xl font-semibold text-gray-100">{{.Data.Session.Session.CompactionCount}}</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Conversation View -->
    <div class="bg-gray-800 shadow-lg shadow-gray-900/50 border border-gray-700 rounded-lg overflow-hidden">
        <div class="px-4 py-5 sm:px-6 border-b border-gray-700 flex justify-between items-center">
            <div class="flex items-center space-x-3">
                <div class="flex-shrink-0 bg-cyan-500/20 rounded-full p-2">
                    <svg class="h-5 w-5 text-cyan-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"></path>
                    </svg>
                </div>
                <div>
                    <h3 class="text-lg font-medium leading-6 text-gray-100">Conversation</h3>
                    <p class="text-sm text-gray-400">{{.Data.Session.MessageCount}} messages, {{formatTokens .Data.Session.TokenUsage.TotalTokens}} tokens</p>
                </div>
            </div>
            <a href="{{$.BasePath}}/chat/session/{{.Data.Session.Session.ID}}" class="inline-flex items-center rounded-md bg-cyan-600 px-3 py-2 text-sm font-medium text-white shadow-sm hover:bg-cyan-500">
                <svg class="w-4 h-4 mr-1.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path>
                </svg>
                Continue
            </a>
        </div>
        <div class="max-h-[600px] overflow-y-auto p-4 space-y-4 bg-gray-900">
            {{if .Data.Session.Conversation}}
            {{range .Data.Session.Conversation.Messages}}
            {{template "session-message-bubble" (dict "Msg" . "BasePath" $.BasePath)}}
            {{else}}
            <div class="flex items-center justify-center py-12 text-gray-400">
                <div class="text-center">
                    <svg class="mx-auto h-12 w-12 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"></path>
                    </svg>
                    <h3 class="mt-2 text-sm font-medium text-gray-100">No messages yet</h3>
                    <p class="mt-1 text-sm text-gray-400">Start a conversation to see messages here.</p>
                    <a href="{{$.BasePath}}/chat/session/{{.Data.Session.Session.ID}}" class="mt-4 inline-flex items-center rounded-md bg-cyan-600 px-3 py-2 text-sm font-medium text-white shadow-sm hover:bg-cyan-500">
                        Start Chat
                    </a>
                </div>
            </div>
            {{end}}
            {{else}}
            <div class="flex items-center justify-center py-12 text-gray-400">
                <div class="text-center">
                    <p class="text-sm">Conversation data not available.</p>
                </div>
            </div>
            {{end}}
        </div>
    </div>

    <!-- Session Details -->
    <div class="bg-gray-800 shadow-lg shadow-gray-900/50 border border-gray-700 rounded-lg overflow-hidden">
        <div class="px-4 py-5 sm:px-6 border-b border-gray-700">
            <h3 class="text-lg font-medium leading-6 text-gray-100">Session Details</h3>
        </div>
        <div class="px-4 py-5 sm:p-6">
            <dl class="grid grid-cols-1 gap-x-4 gap-y-6 sm:grid-cols-3">
                <div>
                    <dt class="text-sm font-medium text-gray-400">Session ID</dt>
                    <dd class="mt-1 text-sm text-gray-200 font-mono bg-gray-900 border border-gray-700 rounded px-2 py-1 inline-block">{{.Data.Session.Session.ID}}</dd>
                </div>
                <div>
                    <dt class="text-sm font-medium text-gray-400">Tenant</dt>
                    <dd class="mt-1 text-sm text-gray-200">{{.Data.Session.Session.TenantID}}</dd>
                </div>
                <div>
                    <dt class="text-sm font-medium text-gray-400">Depth</dt>
                    <dd class="mt-1 text-sm text-gray-200">{{.Data.Session.Session.Depth}}</dd>
                </div>
                <div>
                    <dt class="text-sm font-medium text-gray-400">Token Usage</dt>
                    <dd class="mt-1 text-sm text-gray-200">
                        <span class="font-medium">{{formatTokens .Data.Session.TokenUsage.TotalTokens}}</span> total
                        <span class="text-gray-400">({{formatTokens .Data.Session.TokenUsage.InputTokens}} in / {{formatTokens .Data.Session.TokenUsage.OutputTokens}} out)</span>
                    </dd>
                </div>
                <div>
                    <dt class="text-sm font-medium text-gray-400">Created</dt>
                    <dd class="mt-1 text-sm text-gray-200">{{formatTime .Data.Session.Session.CreatedAt}}</dd>
                </div>
                <div>
                    <dt class="text-sm font-medium text-gray-400">Updated</dt>
                    <dd class="mt-1 text-sm text-gray-200">{{formatTime .Data.Session.Session.UpdatedAt}}</dd>
                </div>
            </dl>
        </div>
    </div>

    <!-- Parent/Child Sessions -->
    {{if or .Data.Session.ParentSession .Data.Session.ChildSessions}}
    <div class="bg-gray-800 shadow-lg shadow-gray-900/50 border border-gray-700 rounded-lg overflow-hidden">
        <div class="px-4 py-5 sm:px-6 border-b border-gray-700">
            <h3 class="text-lg font-medium leading-6 text-gray-100">Session Hierarchy</h3>
        </div>
        <div class="px-4 py-5 sm:p-6">
            {{if .Data.Session.ParentSession}}
            <div class="mb-4">
                <h4 class="text-sm font-medium text-gray-400 mb-2">Parent Session</h4>
                <a href="{{$.BasePath}}/sessions/{{.Data.Session.ParentSession.ID}}" class="inline-flex items-center text-cyan-400 hover:text-cyan-300">
                    <svg class="w-4 h-4 mr-1.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16l-4-4m0 0l4-4m-4 4h18"></path>
                    </svg>
                    {{.Data.Session.ParentSession.UserID}}
                </a>
            </div>
            {{end}}
            {{if .Data.Session.ChildSessions}}
            <div>
                <h4 class="text-sm font-medium text-gray-400 mb-2">Child Sessions</h4>
                <ul class="space-y-2">
                    {{range .Data.Session.ChildSessions}}
                    <li class="flex items-center justify-between">
                        <a href="{{$.BasePath}}/sessions/{{.ID}}" class="text-cyan-400 hover:text-cyan-300 flex items-center">
                            <svg class="w-4 h-4 mr-1.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3"></path>
                            </svg>
                            {{.UserID}}
                        </a>
                        <span class="text-sm text-gray-400">{{.RunCount}} runs</span>
                    </li>
                    {{end}}
                </ul>
            </div>
            {{end}}
        </div>
    </div>
    {{end}}

    <!-- Recent Runs -->
    <div class="bg-gray-800 shadow-lg shadow-gray-900/50 border border-gray-700 rounded-lg overflow-hidden">
        <div class="px-4 py-5 sm:px-6 border-b border-gray-700 flex justify-between items-center">
            <div class="flex items-center space-x-3">
                <div class="flex-shrink-0 bg-green-500/20 rounded-full p-2">
                    <svg class="h-5 w-5 text-green-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                    </svg>
                </div>
                <h3 class="text-lg font-medium leading-6 text-gray-100">Recent Runs</h3>
            </div>
            <a href="{{$.BasePath}}/runs?session_id={{.Data.Session.Session.ID}}" class="text-sm text-cyan-400 hover:text-cyan-300 font-medium">View all runs</a>
        </div>
        <ul class="divide-y divide-gray-700">
            {{range .Data.Session.RecentRuns}}
            <li class="hover:bg-gray-700/50 transition-colors">
                <a href="{{$.BasePath}}/runs/{{.ID}}" class="block px-4 py-4">
                    <div class="flex items-center justify-between">
                        <div class="flex items-center space-x-3">
                            <span class="inline-flex items-center rounded-md px-2.5 py-0.5 text-xs font-medium {{stateBgColor .State}}">
                                {{.State}}
                            </span>
                            <span class="font-medium text-gray-100">{{.AgentName}}</span>
                            {{if .HasParent}}
                            <span class="inline-flex items-center rounded-md bg-gray-700 px-2 py-0.5 text-xs font-medium text-gray-300 ring-1 ring-gray-600">
                                <svg class="w-3 h-3 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"></path>
                                </svg>
                                nested
                            </span>
                            {{end}}
                        </div>
                        <span class="text-sm text-gray-400">{{formatTimeAgo .CreatedAt}}</span>
                    </div>
                    <div class="mt-2 flex items-center space-x-4 text-sm text-gray-400">
                        <span class="flex items-center">
                            <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path>
                            </svg>
                            {{.IterationCount}} iterations
                        </span>
                        <span class="flex items-center">
                            <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"></path>
                            </svg>
                            {{formatTokens .TotalTokens}} tokens
                        </span>
                        {{if .Duration}}
                        <span class="flex items-center">
                            <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                            {{formatDuration .Duration}}
                        </span>
                        {{end}}
                    </div>
                </a>
            </li>
            {{else}}
            <li class="px-4 py-8 text-center text-gray-400">
                <svg class="mx-auto h-10 w-10 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                </svg>
                <p class="mt-2 text-sm">No runs yet</p>
            </li>
            {{end}}
        </ul>
    </div>

    <!-- Metadata -->
    {{if .Data.Session.Session.Metadata}}
    <div class="bg-gray-800 shadow-lg shadow-gray-900/50 border border-gray-700 rounded-lg overflow-hidden">
        <div class="px-4 py-5 sm:px-6 border-b border-gray-700">
            <h3 class="text-lg font-medium leading-6 text-gray-100">Metadata</h3>
        </div>
        <div class="px-4 py-5 sm:p-6">
            <pre class="text-sm text-green-400 bg-gray-950 border border-gray-700 rounded-lg p-4 overflow-x-auto">{{json .Data.Session.Session.Metadata}}</pre>
        </div>
    </div>
    {{end}}
</div>
{{end}}

{{define "session-message-bubble"}}
<div class="flex {{if eq .Msg.Message.Role "user"}}justify-end{{else}}justify-start{{end}}">
    <div class="max-w-3xl {{if eq .Msg.Message.Role "user"}}bg-cyan-700 text-white{{else}}bg-gray-800 border border-gray-700 text-gray-100{{end}} rounded-lg px-4 py-3 shadow-sm">
        {{if .Msg.RunInfo}}
        <div class="flex items-center space-x-2 mb-2 {{if eq .Msg.Message.Role "user"}}text-cyan-200{{else}}text-gray-400{{end}} text-xs">
            <span class="font-medium">{{.Msg.RunInfo.AgentName}}</span>
            <span>|</span>
            <a href="{{.BasePath}}/runs/{{.Msg.RunInfo.ID}}" class="hover:underline">View Run</a>
        </div>
        {{end}}

        {{$msgRole := .Msg.Message.Role}}
        {{range .Msg.ContentBlocks}}
        {{if eq .Type "text"}}
        <div class="prose prose-sm prose-invert max-w-none [&_pre]:bg-gray-950 [&_pre]:text-green-400 [&_pre]:border [&_pre]:border-gray-700 [&_pre]:rounded-lg [&_pre]:p-4 [&_pre]:overflow-x-auto [&_code]:bg-gray-700 [&_code]:text-cyan-400 [&_code]:px-1 [&_code]:py-0.5 [&_code]:rounded [&_pre_code]:bg-transparent [&_pre_code]:text-green-400 [&_a]:text-cyan-400">{{markdown .Text}}</div>
        {{else if eq .Type "tool_use"}}
        <div class="mt-2 p-3 rounded-md {{if eq $msgRole "user"}}bg-cyan-700{{else}}bg-gray-700/50 border border-gray-600{{end}}">
            <div class="flex items-center space-x-2">
                <svg class="w-4 h-4 {{if eq $msgRole "user"}}text-cyan-300{{else}}text-purple-400{{end}}" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"></path>
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
                </svg>
                <span class="font-medium text-white">{{.ToolName}}</span>
            </div>
            <details class="mt-2">
                <summary class="text-xs {{if eq $msgRole "user"}}text-cyan-300{{else}}text-gray-400{{end}} cursor-pointer">View Input</summary>
                <pre class="mt-1 text-xs text-gray-300 bg-gray-950 border border-gray-700 p-2 rounded overflow-x-auto">{{json .ToolInput}}</pre>
            </details>
        </div>
        {{else if eq .Type "tool_result"}}
        <div class="mt-2 p-3 rounded-md {{if .IsError}}bg-red-500/10 border border-red-500/30{{else if eq $msgRole "user"}}bg-cyan-700{{else}}bg-green-500/10 border border-green-500/30{{end}}">
            <div class="flex items-center space-x-2">
                {{if .IsError}}
                <svg class="w-4 h-4 text-red-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path>
                </svg>
                <span class="font-medium text-red-400">Error</span>
                {{else}}
                <svg class="w-4 h-4 {{if eq $msgRole "user"}}text-cyan-300{{else}}text-green-400{{end}}" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                </svg>
                <span class="font-medium {{if eq $msgRole "user"}}text-white{{else}}text-green-400{{end}}">Result</span>
                {{end}}
            </div>
            <pre class="mt-1 text-sm {{if .IsError}}text-red-300{{else if eq $msgRole "user"}}text-cyan-200{{else}}text-green-300{{end}} whitespace-pre-wrap overflow-x-auto">{{.ToolContent | truncate 500}}</pre>
        </div>
        {{else if eq .Type "thinking"}}
        <div class="mt-2 p-3 rounded-md bg-amber-500/10 border border-amber-500/30">
            <div class="flex items-center space-x-2">
                <svg class="w-4 h-4 text-amber-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"></path>
                </svg>
                <span class="font-medium text-amber-400">Thinking</span>
            </div>
            <p class="mt-1 text-sm text-amber-300 whitespace-pre-wrap">{{.Text | truncate 300}}</p>
        </div>
        {{end}}
        {{end}}

        <div class="mt-2 text-xs {{if eq .Msg.Message.Role "user"}}text-cyan-300{{else}}text-gray-500{{end}}">
            {{formatTimeAgo .Msg.Message.CreatedAt}}
        </div>
    </div>
</div>
{{end}}
